<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.6">
  <compounddef id="_reference_class___pre_8cpp" kind="file">
    <compoundname>ReferenceClass_Pre.cpp</compoundname>
    <includes refid="_c_p_p_w_i_t_h_c_s_h_a_r_p_2_stdafx_8h" local="yes">stdafx.h</includes>
    <includes local="no">vcclr.h</includes>
    <includes local="no">msclr/marshal_cppstd.h</includes>
    <includes refid="_reference_class___pre_8h" local="yes">ReferenceClass_Pre.h</includes>
    <incdepgraph>
      <node id="223">
        <label>atlstr.h</label>
      </node>
      <node id="217">
        <label>msclr/marshal_cppstd.h</label>
      </node>
      <node id="215">
        <label>stdafx.h</label>
        <link refid="_c_p_p_w_i_t_h_c_s_h_a_r_p_2_stdafx_8h"/>
      </node>
      <node id="245">
        <label>strstream</label>
      </node>
      <node id="229">
        <label>stdlib.h</label>
      </node>
      <node id="248">
        <label>Feature.h</label>
        <link refid="_pre_manager_2ref_2_feature_8h"/>
        <childnode refid="239" relation="include">
        </childnode>
      </node>
      <node id="231">
        <label>cmath</label>
      </node>
      <node id="214">
        <label>CPPWITHCSHARP/ReferenceClass_Pre.cpp</label>
        <link refid="ReferenceClass_Pre.cpp"/>
        <childnode refid="215" relation="include">
        </childnode>
        <childnode refid="216" relation="include">
        </childnode>
        <childnode refid="217" relation="include">
        </childnode>
        <childnode refid="218" relation="include">
        </childnode>
      </node>
      <node id="225">
        <label>string</label>
      </node>
      <node id="243">
        <label>comdef.h</label>
      </node>
      <node id="230">
        <label>comutil.h</label>
      </node>
      <node id="246">
        <label>..\PreManager\ref\ReferenceEntity.h</label>
        <link refid="_reference_entity_8h"/>
        <childnode refid="239" relation="include">
        </childnode>
        <childnode refid="247" relation="include">
        </childnode>
      </node>
      <node id="219">
        <label>ReferenceClass.h</label>
        <link refid="_reference_class_8h"/>
        <childnode refid="220" relation="include">
        </childnode>
        <childnode refid="221" relation="include">
        </childnode>
        <childnode refid="232" relation="include">
        </childnode>
        <childnode refid="239" relation="include">
        </childnode>
        <childnode refid="240" relation="include">
        </childnode>
        <childnode refid="246" relation="include">
        </childnode>
        <childnode refid="216" relation="include">
        </childnode>
        <childnode refid="217" relation="include">
        </childnode>
      </node>
      <node id="247">
        <label>FSketch.h</label>
        <link refid="_pre_manager_2ref_2_f_sketch_8h"/>
        <childnode refid="248" relation="include">
        </childnode>
      </node>
      <node id="226">
        <label>fstream</label>
      </node>
      <node id="220">
        <label>..\PostManager\ref\Part.h</label>
        <link refid="_post_manager_2ref_2_part_8h"/>
        <childnode refid="221" relation="include">
        </childnode>
        <childnode refid="234" relation="include">
        </childnode>
      </node>
      <node id="218">
        <label>ReferenceClass_Pre.h</label>
        <link refid="_reference_class___pre_8h"/>
        <childnode refid="219" relation="include">
        </childnode>
      </node>
      <node id="238">
        <label>MP_Utility.h</label>
        <link refid="_m_p___utility_8h"/>
        <childnode refid="235" relation="include">
        </childnode>
      </node>
      <node id="237">
        <label>string.h</label>
      </node>
      <node id="240">
        <label>CATIApre_DLL.h</label>
        <link refid="_c_a_t_i_apre___d_l_l_8h"/>
        <childnode refid="228" relation="include">
        </childnode>
        <childnode refid="241" relation="include">
        </childnode>
        <childnode refid="225" relation="include">
        </childnode>
        <childnode refid="237" relation="include">
        </childnode>
        <childnode refid="224" relation="include">
        </childnode>
        <childnode refid="226" relation="include">
        </childnode>
        <childnode refid="227" relation="include">
        </childnode>
        <childnode refid="231" relation="include">
        </childnode>
        <childnode refid="233" relation="include">
        </childnode>
        <childnode refid="242" relation="include">
        </childnode>
        <childnode refid="230" relation="include">
        </childnode>
        <childnode refid="243" relation="include">
        </childnode>
        <childnode refid="244" relation="include">
        </childnode>
      </node>
      <node id="227">
        <label>vector</label>
      </node>
      <node id="242">
        <label>sstream</label>
      </node>
      <node id="233">
        <label>math.h</label>
      </node>
      <node id="222">
        <label>atlbase.h</label>
      </node>
      <node id="234">
        <label>CATIAReferenceManager.h</label>
        <link refid="_c_a_t_i_a_reference_manager_8h"/>
        <childnode refid="221" relation="include">
        </childnode>
        <childnode refid="235" relation="include">
        </childnode>
        <childnode refid="238" relation="include">
        </childnode>
      </node>
      <node id="224">
        <label>iostream</label>
      </node>
      <node id="232">
        <label>Definition.h</label>
        <link refid="_post_manager_2ref_2_definition_8h"/>
        <childnode refid="233" relation="include">
        </childnode>
      </node>
      <node id="241">
        <label>tchar.h</label>
      </node>
      <node id="244">
        <label>Definition.h</label>
        <link refid="_pre_manager_2ref_2_definition_8h"/>
        <childnode refid="245" relation="include">
        </childnode>
        <childnode refid="224" relation="include">
        </childnode>
        <childnode refid="233" relation="include">
        </childnode>
      </node>
      <node id="216">
        <label>vcclr.h</label>
      </node>
      <node id="239">
        <label>..\PreManager\ref\Part.h</label>
        <link refid="_pre_manager_2ref_2_part_8h"/>
        <childnode refid="240" relation="include">
        </childnode>
      </node>
      <node id="236">
        <label>algorithm</label>
      </node>
      <node id="228">
        <label>stdio.h</label>
      </node>
      <node id="235">
        <label>PN_TYPE.h</label>
        <link refid="_p_n___t_y_p_e_8h"/>
        <childnode refid="224" relation="include">
        </childnode>
        <childnode refid="225" relation="include">
        </childnode>
        <childnode refid="227" relation="include">
        </childnode>
        <childnode refid="236" relation="include">
        </childnode>
        <childnode refid="233" relation="include">
        </childnode>
        <childnode refid="237" relation="include">
        </childnode>
      </node>
      <node id="221">
        <label>CATIApost_DLL.h</label>
        <link refid="_c_a_t_i_apost___d_l_l_8h"/>
        <childnode refid="222" relation="include">
        </childnode>
        <childnode refid="223" relation="include">
        </childnode>
        <childnode refid="224" relation="include">
        </childnode>
        <childnode refid="225" relation="include">
        </childnode>
        <childnode refid="226" relation="include">
        </childnode>
        <childnode refid="227" relation="include">
        </childnode>
        <childnode refid="228" relation="include">
        </childnode>
        <childnode refid="229" relation="include">
        </childnode>
        <childnode refid="230" relation="include">
        </childnode>
        <childnode refid="231" relation="include">
        </childnode>
        <childnode refid="232" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <innernamespace refid="namespace_reference_class">ReferenceClass</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="_c_p_p_w_i_t_h_c_s_h_a_r_p_2_stdafx_8h" kindref="compound">stdafx.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;vcclr.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;msclr/marshal_cppstd.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="_reference_class___pre_8h" kindref="compound">ReferenceClass_Pre.h</ref>&quot;</highlight></codeline>
<codeline lineno="11"><highlight class="keyword">namespace<sp/></highlight><highlight class="normal">ReferenceClass</highlight></codeline>
<codeline lineno="12"><highlight class="normal">{</highlight></codeline>
<codeline lineno="13"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//생성자<sp/>C++<sp/>코드<sp/>Dll<sp/>연결시켜주는<sp/>곳</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//TestEnvironment가<sp/>필요<sp/>없다면<sp/>이<sp/>생성자<sp/>사용</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16" refid="class_reference_class_1_1ref___pre_1a83c8590946e5baf2c304cfc3d9526cc7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_reference_class_1_1ref___pre_1a83c8590946e5baf2c304cfc3d9526cc7" kindref="member">ref_Pre::ref_Pre</ref>()<sp/>{</highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//COM<sp/>Initialize</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>status<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HRESULT<sp/>hr<sp/>=<sp/>CoInitialize(NULL);</highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hr<sp/>=<sp/><ref refid="namespace_pre_1ab590816a169f99c588976c3b9a269fbd" kindref="member">Pre::g_spApplication</ref>.CreateInstance(__uuidof(TransCAD::Application));</highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FAILED(hr))status<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="namespace_pre_1ab590816a169f99c588976c3b9a269fbd" kindref="member">Pre::g_spApplication</ref>-&gt;Visible)<sp/>{<sp/><ref refid="namespace_pre_1ab590816a169f99c588976c3b9a269fbd" kindref="member">Pre::g_spApplication</ref>-&gt;Visible<sp/>=<sp/>VARIANT_TRUE;<sp/>}</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_reference_class_1_1ref___pre_1a21ed6ea22faa931d53ee4e59b21d6749" kindref="member">_spAssemDocument</ref><sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>TransCAD::IAssemDocumentPtr();</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_reference_class_1_1ref___pre_1af7d8f4c68eeb85e8e5edee16761d355a" kindref="member">_spAssem</ref><sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>TransCAD::IAssemPtr();</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//현재<sp/>Assem<sp/>Document<sp/>가져오기</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//TransCAD::IAssemDocumentPtr<sp/>set<sp/>=<sp/>Pre::g_spApplication-&gt;ActiveDocument;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//*_spAssemDocument<sp/>=<sp/>Pre::g_spApplication-&gt;ActiveDocument;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="class_reference_class_1_1ref___pre_1af7d8f4c68eeb85e8e5edee16761d355a" kindref="member">_spAssem</ref><sp/>=<sp/>(*_spAssemDocument)-&gt;GetAssem();</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_reference_class_1_1ref___pre_1acad4634ae08a868ca337cf9020e21e18" kindref="member">pre_data</ref><sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="structparsing" kindref="compound">parsing</ref>();</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//TestEnvironment가<sp/>필요하면<sp/>이<sp/>생성자<sp/>사용</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38" refid="class_reference_class_1_1ref___pre_1a3ea7b9b3a1602cde34ba327a97131675" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_reference_class_1_1ref___pre_1a83c8590946e5baf2c304cfc3d9526cc7" kindref="member">ref_Pre::ref_Pre</ref>(<ref refid="class_pre_stack" kindref="compound">PreStack</ref>^<sp/>buffer)<sp/>{</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_reference_class_1_1ref___pre_1af46f69f170b7626db974e08e24894353" kindref="member">TestEnvironment</ref>(buffer);</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//COM<sp/>Initialize</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>status<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HRESULT<sp/>hr<sp/>=<sp/>CoInitialize(NULL);</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hr<sp/>=<sp/><ref refid="namespace_pre_1ab590816a169f99c588976c3b9a269fbd" kindref="member">Pre::g_spApplication</ref>.CreateInstance(__uuidof(TransCAD::Application));</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FAILED(hr))status<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="namespace_pre_1ab590816a169f99c588976c3b9a269fbd" kindref="member">Pre::g_spApplication</ref>-&gt;Visible)<sp/>{<sp/><ref refid="namespace_pre_1ab590816a169f99c588976c3b9a269fbd" kindref="member">Pre::g_spApplication</ref>-&gt;Visible<sp/>=<sp/>VARIANT_TRUE;<sp/>}</highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_reference_class_1_1ref___pre_1a21ed6ea22faa931d53ee4e59b21d6749" kindref="member">_spAssemDocument</ref><sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>TransCAD::IAssemDocumentPtr();</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_reference_class_1_1ref___pre_1af7d8f4c68eeb85e8e5edee16761d355a" kindref="member">_spAssem</ref><sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>TransCAD::IAssemPtr();</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//현재<sp/>Assem<sp/>Document<sp/>가져오기</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//TransCAD::IAssemDocumentPtr<sp/>set<sp/>=<sp/>Pre::g_spApplication-&gt;ActiveDocument;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="class_reference_class_1_1ref___pre_1a21ed6ea22faa931d53ee4e59b21d6749" kindref="member">_spAssemDocument</ref><sp/>=<sp/><ref refid="namespace_pre_1ab590816a169f99c588976c3b9a269fbd" kindref="member">Pre::g_spApplication</ref>-&gt;ActiveDocument;</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="class_reference_class_1_1ref___pre_1af7d8f4c68eeb85e8e5edee16761d355a" kindref="member">_spAssem</ref><sp/>=<sp/>(*_spAssemDocument)-&gt;GetAssem();</highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_reference_class_1_1ref___pre_1acad4634ae08a868ca337cf9020e21e18" kindref="member">pre_data</ref><sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="structparsing" kindref="compound">parsing</ref>();</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//소멸자</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64" refid="class_reference_class_1_1ref___pre_1a54f9805513c471dfca835ed445d724af" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_reference_class_1_1ref___pre_1a54f9805513c471dfca835ed445d724af" kindref="member">ref_Pre::~ref_Pre</ref>()<sp/>{<sp/>::CoUninitialize();<sp/>}</highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight></codeline>
<codeline lineno="66" refid="class_reference_class_1_1ref___pre_1af46f69f170b7626db974e08e24894353" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_reference_class_1_1ref___pre_1af46f69f170b7626db974e08e24894353" kindref="member">ref_Pre::TestEnvironment</ref>(<ref refid="class_pre_stack" kindref="compound">PreStack</ref>^<sp/>buffer)<sp/>{</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//COM<sp/>Initialize</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>status<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HRESULT<sp/>hr<sp/>=<sp/>CoInitialize(NULL);</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//TransCAD<sp/>instance<sp/>생성</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hr<sp/>=<sp/><ref refid="namespace_pre_1ab590816a169f99c588976c3b9a269fbd" kindref="member">Pre::g_spApplication</ref>.CreateInstance(__uuidof(TransCAD::Application));</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//TrnasCAD<sp/>initialzie<sp/>error<sp/>check</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(FAILED(hr))status<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//TransCAD<sp/>가시화</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="namespace_pre_1ab590816a169f99c588976c3b9a269fbd" kindref="member">Pre::g_spApplication</ref>-&gt;Visible)<sp/>{</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespace_pre_1ab590816a169f99c588976c3b9a269fbd" kindref="member">Pre::g_spApplication</ref>-&gt;Visible<sp/>=<sp/>VARIANT_TRUE;</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TransCAD::IAssemDocumentPtr<sp/><ref refid="class_reference_class_1_1ref___pre_1a21ed6ea22faa931d53ee4e59b21d6749" kindref="member">_spAssemDocument</ref>;</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TransCAD::IAssemPtr<sp/><ref refid="class_reference_class_1_1ref___pre_1af7d8f4c68eeb85e8e5edee16761d355a" kindref="member">_spAssem</ref>;</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TransCAD::ICompPtr<sp/><ref refid="class_reference_class_1_1ref___pre_1a89793ff594f20a555df1142984c48da6" kindref="member">_spComp</ref>;</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TransCAD::IPartDocumentPtr<sp/>_spPartDocument;</highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>part_size<sp/>=<sp/>buffer-&gt;<ref refid="class_pre_stack_1adb9f10b73879559db98cc9e418f79a48" kindref="member">GetSize</ref>();</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TransCAD::IPartPtr<sp/>*_tPart<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>TransCAD::IPartPtr[part_size];</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>part_size;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//파트<sp/>Script<sp/>파일<sp/>경로<sp/>얻어오기<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>pPath<sp/>=<sp/><ref refid="_reference_class_8cpp_1a27d7884109d4b05adb7fd28a8a98a7ce" kindref="member">Stos</ref>(buffer-&gt;<ref refid="class_pre_stack_1a2dc1d77864de7e01e83891bd46777f7c" kindref="member">Getitem_from_index</ref>(0,<sp/>i));<sp/></highlight><highlight class="comment">//0<sp/>:<sp/>_dir</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pPath<sp/>=<sp/><ref refid="_reference_class_8cpp_1a845542c4adade4e6695e66ef7405b936" kindref="member">replace_all</ref>(pPath,<sp/></highlight><highlight class="stringliteral">&quot;CATPart&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;CATScript&quot;</highlight><highlight class="normal">);<sp/></highlight><highlight class="comment">//.CATPart<sp/>-&gt;<sp/>.CATScript</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//파트<sp/>Script<sp/>파일<sp/>번역</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_spPartDocument<sp/>=<sp/><ref refid="namespace_pre_1ab590816a169f99c588976c3b9a269fbd" kindref="member">Pre::g_spApplication</ref>-&gt;GetDocuments()-&gt;AddPartDocument();</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_pre_1_1_part" kindref="compound">Pre::Part</ref><sp/>*pConstrained<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_pre_1_1_part" kindref="compound">Pre::Part</ref>(pPath,<sp/>_spPartDocument);</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pConstrained-&gt;<ref refid="class_pre_1_1_part_1a8b5e2a2bbf385223d67ce40232b23e45" kindref="member">GetInfo</ref>();</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pConstrained-&gt;<ref refid="class_pre_1_1_part_1aa981061fc510bc931b60ce995551281b" kindref="member">ToTransCAD</ref>();</highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_tPart[i]<sp/>=<sp/>pConstrained-&gt;<ref refid="class_pre_1_1_part_1abe7d81bc84a9423e1d09c27e36125b64" kindref="member">_spPart</ref>;</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Part<sp/>%d<sp/>is<sp/>success<sp/>translated&quot;</highlight><highlight class="normal">,<sp/>i);</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//어셈블리<sp/>다큐먼트<sp/>생성<sp/>및<sp/>파트<sp/>파일<sp/>추가</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_spAssemDocument<sp/>=<sp/><ref refid="namespace_pre_1ab590816a169f99c588976c3b9a269fbd" kindref="member">Pre::g_spApplication</ref>-&gt;GetDocuments()-&gt;AddAssemDocument();</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_spAssemDocument<sp/>=<sp/><ref refid="namespace_pre_1ab590816a169f99c588976c3b9a269fbd" kindref="member">Pre::g_spApplication</ref>-&gt;ActiveDocument;</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_spAssem<sp/>=<sp/>_spAssemDocument-&gt;GetAssem();</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_spComp<sp/>=<sp/>_spAssem-&gt;CreateComponent();</highlight><highlight class="comment">//SubAssembly1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_spComp-&gt;set_Name(</highlight><highlight class="stringliteral">&quot;Component1&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>part_size;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_spComp-&gt;AddPart(_tPart[i]);</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_spAssem-&gt;AddComponent(_spComp);</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_spAssemDocument-&gt;Update();</highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="123" refid="class_reference_class_1_1ref___pre_1aa86023525dbb1186e4c9247399445a24" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_reference_class_1_1ref___pre_1aa86023525dbb1186e4c9247399445a24" kindref="member">ref_Pre::PreTest</ref>(<ref refid="class_pre_stack" kindref="compound">PreStack</ref>^<sp/>buffer,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>totnum,<sp/>String^<sp/>_CstType,<sp/>String^<sp/>_master_ref,<sp/>String^<sp/>_slave_ref)</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structref_command" kindref="compound">refCommand</ref><sp/>ref_Pre::SetConstraint(<ref refid="class_pre_stack" kindref="compound">PreStack</ref>^<sp/>buffer,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>totnum,<sp/>String^<sp/>_CstType,<sp/>String^<sp/>_master_ref,<sp/>String^<sp/>_slave_ref,<sp/>String^<sp/>_option,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">^<sp/>_option_int)</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>SetConstraint(PreStack<sp/>인스턴스<sp/>,<sp/>int<sp/>파트개수<sp/>,<sp/>string<sp/>Const타입<sp/>,<sp/>string<sp/>MasterRef,<sp/>string<sp/>SlaveRef,<sp/>string<sp/>option,<sp/>int<sp/>optionNum)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*Input<sp/>값</highlight></codeline>
<codeline lineno="134"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1<sp/>:<sp/>Total<sp/>Part<sp/>Num</highlight></codeline>
<codeline lineno="135"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2<sp/>:<sp/>[Rotation,Body],<sp/>[Part1,Part1],<sp/>[D:\\project\\Macro\\TestAssem\\SubAssembly1\\RotationPart.CATScript,<sp/>&quot;D:\project\Macro\TestAssem\SubAssembly1\Body.CATPart&quot;]</highlight></codeline>
<codeline lineno="136"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(TransCAD이름/파일_이름,<sp/>CATIA이름,<sp/>CATIA이름에<sp/>따른<sp/>경로)</highlight></codeline>
<codeline lineno="137"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>3<sp/>:<sp/>catCstTypeOn,</highlight></codeline>
<codeline lineno="138"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4<sp/>:<sp/>&quot;Product1/Part1.1/!Axis:(Selection_RSur:(Face:(Brp:(Pocket.1;0:(Brp:(Sketch.2;4)));None:();Cf11:());Pocket.1_ResultOUT;Z0;G3563))&quot;</highlight></codeline>
<codeline lineno="139"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>5<sp/>:<sp/>&quot;Product1/Part1.2/!Axis:(Selection_RSur:(Face:(Brp:(Pad.2;0:(Brp:(Sketch.2;4)));None:();Cf11:());Pad.2_ResultOUT;Z0;G3563))&quot;</highlight></codeline>
<codeline lineno="140"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Step1<sp/>:<sp/>초기화<sp/>-<sp/>TrnasCAD<sp/>및<sp/>Pre<sp/>변수<sp/>초기화</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>region<sp/>Step1<sp/>:<sp/>초기화<sp/>-<sp/>TrnasCAD<sp/>및<sp/>Pre<sp/>변수<sp/>초기화</highlight></codeline>
<codeline lineno="144"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>CstType<sp/>=<sp/><ref refid="_reference_class_8cpp_1a27d7884109d4b05adb7fd28a8a98a7ce" kindref="member">Stos</ref>(_CstType);</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>full_ref[(int)<ref refid="class_reference_class_1_1ref___pre_1aa03606a79215698128eb9e4c1c985c1bac76f2bdb601e9957ef1376220546b782" kindref="member">TARGETPART::REFERENCE_SIZE</ref>]<sp/>=<sp/>{<sp/><ref refid="_reference_class_8cpp_1a27d7884109d4b05adb7fd28a8a98a7ce" kindref="member">Stos</ref>(_master_ref),<sp/><ref refid="_reference_class_8cpp_1a27d7884109d4b05adb7fd28a8a98a7ce" kindref="member">Stos</ref>(_slave_ref)<sp/>};</highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//현재<sp/>Assem<sp/>Document<sp/>가져오기</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Pre::g_spApplication.CreateInstance(__uuidof(TransCAD::Application));</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="class_reference_class_1_1ref___pre_1a21ed6ea22faa931d53ee4e59b21d6749" kindref="member">_spAssemDocument</ref><sp/>=<sp/><ref refid="namespace_pre_1ab590816a169f99c588976c3b9a269fbd" kindref="member">Pre::g_spApplication</ref>-&gt;ActiveDocument;</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<ref refid="class_reference_class_1_1ref___pre_1af7d8f4c68eeb85e8e5edee16761d355a" kindref="member">_spAssem</ref><sp/>=<sp/>(*_spAssemDocument)-&gt;GetAssem();</highlight></codeline>
<codeline lineno="152"><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>endregion<sp/></highlight></codeline>
<codeline lineno="155"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>region<sp/>Step2<sp/>:parsing<sp/>&amp;<sp/>Translate</highlight></codeline>
<codeline lineno="157"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TransCAD::ICompPtr<sp/>_IspComp;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TransCAD::IPartPtr<sp/>TargetPart[(int)<ref refid="class_reference_class_1_1ref___pre_1aa03606a79215698128eb9e4c1c985c1bac76f2bdb601e9957ef1376220546b782" kindref="member">TARGETPART::REFERENCE_SIZE</ref>];<sp/></highlight><highlight class="comment">//MASTER,SLAVE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>index[(int)<ref refid="class_reference_class_1_1ref___pre_1aa03606a79215698128eb9e4c1c985c1bac76f2bdb601e9957ef1376220546b782" kindref="member">TARGETPART::REFERENCE_SIZE</ref>];</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>trans_ref[(int)<ref refid="class_reference_class_1_1ref___pre_1aa03606a79215698128eb9e4c1c985c1bac76f2bdb601e9957ef1376220546b782" kindref="member">TARGETPART::REFERENCE_SIZE</ref>];</highlight></codeline>
<codeline lineno="164"><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/********Step2_1<sp/>:<sp/>cn<sp/>=<sp/>0<sp/>:<sp/>Master<sp/>Part와<sp/>Master_geometry<sp/>찾기********/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/********Step2_1<sp/>:<sp/>cn<sp/>=<sp/>1<sp/>:<sp/>Slave<sp/>Part와<sp/>Slave_geometry<sp/>찾기********/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cn<sp/>=<sp/>0;<sp/>cn<sp/>&lt;<sp/>2;<sp/>cn++)<sp/>{</highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_reference_class_1_1ref___pre_1a68edab67fd4e452677bb5b2d783b5085" kindref="member">Parsing</ref>(<ref refid="_reference_class_8cpp_1a1df4caf6a0641fd90e6044b6b29da131" kindref="member">stoS</ref>(full_ref[cn]),<sp/>&amp;<ref refid="class_reference_class_1_1ref___pre_1acad4634ae08a868ca337cf9020e21e18" kindref="member">pre_data</ref>-&gt;<ref refid="structparsing_1a602513d02949072c8892d5af6714c54c" kindref="member">assem_product</ref>,<sp/>&amp;<ref refid="class_reference_class_1_1ref___pre_1acad4634ae08a868ca337cf9020e21e18" kindref="member">pre_data</ref>-&gt;<ref refid="structparsing_1adbcbf43366347f99b814fb375be7c162" kindref="member">assem_part</ref>,<sp/>&amp;<ref refid="class_reference_class_1_1ref___pre_1acad4634ae08a868ca337cf9020e21e18" kindref="member">pre_data</ref>-&gt;<ref refid="structparsing_1a5402c87864310e1985935b298bce61f9" kindref="member">assem_geometry</ref>);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index[cn]<sp/>=<sp/><ref refid="class_reference_class_1_1ref___pre_1a8d058d5b4069f52fe9673bc9202f3cd0" kindref="member">GetTransCADName_from_buffer</ref>(buffer,<sp/>&amp;<ref refid="class_reference_class_1_1ref___pre_1acad4634ae08a868ca337cf9020e21e18" kindref="member">pre_data</ref>-&gt;<ref refid="structparsing_1a6df6e4ec319c51851468f9da22f46387" kindref="member">Transcad_subAssemName</ref>,<sp/>&amp;<ref refid="class_reference_class_1_1ref___pre_1acad4634ae08a868ca337cf9020e21e18" kindref="member">pre_data</ref>-&gt;<ref refid="structparsing_1a15e17ea458bb46d47f86933bdd19e5e6" kindref="member">Transcad_partName</ref>,<sp/>&amp;<ref refid="class_reference_class_1_1ref___pre_1acad4634ae08a868ca337cf9020e21e18" kindref="member">pre_data</ref>-&gt;<ref refid="structparsing_1a7fe5daec7f55129d5d4eace71208b285" kindref="member">Transcad_geometry</ref>);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>trans_ref[cn]<sp/>=<sp/><ref refid="class_reference_class_1_1ref___pre_1acad4634ae08a868ca337cf9020e21e18" kindref="member">pre_data</ref>-&gt;<ref refid="structparsing_1a7fe5daec7f55129d5d4eace71208b285" kindref="member">Transcad_geometry</ref>;</highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//transcad<sp/>name<sp/>을<sp/>통해<sp/>TransCAD<sp/>Part<sp/>인스턴스를<sp/>가져옴</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_IspComp<sp/>=<sp/>(*_spAssem)-&gt;GetComponent(<ref refid="class_reference_class_1_1ref___pre_1acad4634ae08a868ca337cf9020e21e18" kindref="member">pre_data</ref>-&gt;<ref refid="structparsing_1a291835b970e948e4aefe92403bcd5589" kindref="member">product_num</ref>);</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>_IspComp-&gt;GetSize();<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((</highlight><highlight class="keywordtype">string</highlight><highlight class="normal">)(_IspComp-&gt;GetPart(i)-&gt;Name)<sp/>==<sp/><ref refid="class_reference_class_1_1ref___pre_1acad4634ae08a868ca337cf9020e21e18" kindref="member">pre_data</ref>-&gt;<ref refid="structparsing_1a15e17ea458bb46d47f86933bdd19e5e6" kindref="member">Transcad_partName</ref>)<sp/>{</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TargetPart[cn]<sp/>=<sp/>_IspComp-&gt;GetPart(i);</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>endregion</highlight></codeline>
<codeline lineno="189"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>region<sp/>Step3<sp/>:<sp/>TransCAD에<sp/>Constraint<sp/>적용</highlight></codeline>
<codeline lineno="191"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Constraints관리자를<sp/>가져오고,<sp/>//각<sp/>Contratint의<sp/>Master/Slave<sp/>Part의<sp/>Reference<sp/>Name을<sp/>저장할<sp/>ReferencePtr을<sp/>생성<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TransCAD::IStdAssemConstraintsPtr<sp/>_spConstraints;</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_spConstraints<sp/>=<sp/>(*_spAssem)-&gt;GetConstraints();</highlight><highlight class="comment">//Constraint<sp/>관리자</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TransCAD::IReferencePtr<sp/>_spConstrainedGeometry,<sp/>_spReferGeometry;</highlight></codeline>
<codeline lineno="196"><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//각<sp/>Constraint의<sp/>Master<sp/>Part의<sp/>Reference<sp/>Name을<sp/>_spConstrainedGeometry에<sp/>저장</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//각<sp/>Constraint의<sp/>Slave<sp/>Part의<sp/>Reference<sp/>Name을<sp/>_spReferGeometry에<sp/>저장</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_spConstrainedGeometry<sp/>=<sp/>TargetPart[(int)<ref refid="class_reference_class_1_1ref___pre_1aa03606a79215698128eb9e4c1c985c1ba89a1533c37ec9254f22b5e0f29c9c0ff" kindref="member">TARGETPART::MASTER</ref>]-&gt;SelectBrepByName(trans_ref[(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<ref refid="class_reference_class_1_1ref___pre_1aa03606a79215698128eb9e4c1c985c1b" kindref="member">TARGETPART</ref>::MASTER].c_str());</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_spReferGeometry<sp/>=<sp/>TargetPart[(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<ref refid="class_reference_class_1_1ref___pre_1aa03606a79215698128eb9e4c1c985c1b" kindref="member">TARGETPART</ref>::SLAVE]-&gt;SelectBrepByName(trans_ref[(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<ref refid="class_reference_class_1_1ref___pre_1aa03606a79215698128eb9e4c1c985c1b" kindref="member">TARGETPART</ref>::SLAVE].c_str());</highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Constraint를<sp/>하기<sp/>위해<sp/>Constraint<sp/>관리자에게<sp/>Constraint<sp/>정보를<sp/>넣어<sp/>준다</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//&quot;Constraint<sp/>Type&quot;,<sp/>&quot;Master<sp/>Part&quot;,<sp/>&quot;Master<sp/>Reference<sp/>Name&quot;,<sp/>&quot;Slave<sp/>Part&quot;,<sp/>&quot;Slave<sp/>ReferenceName&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//_spConstraints-&gt;AddNewAssemblyCoaxialConstraint(&quot;Coaxial&quot;,<sp/>MasterPart,<sp/>_spConstrainedGeometry,<sp/>SlavePart,<sp/>_spReferGeometry);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//or<sp/>AddNewAssemblyIncidenceConstraint<sp/>&quot;Incidence&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//_spConstraints-&gt;AddNewAssemblyIncidenceConstraint(&quot;Incidence&quot;,<sp/>TargetPart[(int)TARGETPART::MASTER],<sp/>_spConstrainedGeometry,<sp/>TargetPart[(int)TARGETPART::SLAVE],<sp/>_spReferGeometry,<sp/>TransCAD::StdAssemblyIncidenceType::Opposite);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>fjeiakso<sp/>=<sp/>trans_ref[(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<ref refid="class_reference_class_1_1ref___pre_1aa03606a79215698128eb9e4c1c985c1b" kindref="member">TARGETPART</ref>::MASTER];</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cout<sp/>&lt;&lt;<sp/>fjeiakso<sp/>&lt;&lt;<sp/>endl;</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fjeiakso<sp/>=<sp/>trans_ref[(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<ref refid="class_reference_class_1_1ref___pre_1aa03606a79215698128eb9e4c1c985c1b" kindref="member">TARGETPART</ref>::SLAVE];</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cout<sp/>&lt;&lt;<sp/>fjeiakso<sp/>&lt;&lt;<sp/>endl;</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>param<sp/>=<sp/><ref refid="class_reference_class_1_1ref___pre_1ac8cd404fe503874a3b72314edf6c07ae" kindref="member">Constraint_to_TransCAD</ref>(_spConstraints,<sp/>CstType,<sp/>TargetPart[(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<ref refid="class_reference_class_1_1ref___pre_1aa03606a79215698128eb9e4c1c985c1b" kindref="member">TARGETPART</ref>::MASTER],<sp/>_spConstrainedGeometry,<sp/>TargetPart[(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<ref refid="class_reference_class_1_1ref___pre_1aa03606a79215698128eb9e4c1c985c1b" kindref="member">TARGETPART</ref>::SLAVE],<sp/>_spReferGeometry,<sp/><ref refid="_reference_class_8cpp_1a27d7884109d4b05adb7fd28a8a98a7ce" kindref="member">Stos</ref>(_option),<sp/>_option_int);</highlight></codeline>
<codeline lineno="214"><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(*<ref refid="class_reference_class_1_1ref___pre_1a21ed6ea22faa931d53ee4e59b21d6749" kindref="member">_spAssemDocument</ref>)-&gt;Update();</highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>endregion</highlight></codeline>
<codeline lineno="218"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="219"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>region<sp/>Step3<sp/>:<sp/>결과<sp/>내보내기</highlight></codeline>
<codeline lineno="220"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structref_command" kindref="compound">refCommand</ref><sp/>result;</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.<ref refid="structref_command_1af019dca898c0c6d98f9a33d161df0f51" kindref="member">command</ref><sp/>=<sp/>TRUE;</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.param<sp/>=<sp/><ref refid="_reference_class_8cpp_1a1df4caf6a0641fd90e6044b6b29da131" kindref="member">stoS</ref>(param);</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.MasterPart<sp/>=<sp/>buffer-&gt;<ref refid="class_pre_stack_1a2dc1d77864de7e01e83891bd46777f7c" kindref="member">Getitem_from_index</ref>(2,<sp/>index[(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<ref refid="class_reference_class_1_1ref___pre_1aa03606a79215698128eb9e4c1c985c1ba89a1533c37ec9254f22b5e0f29c9c0ff" kindref="member">TARGETPART::MASTER</ref>]);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.MasterPart_Ref<sp/>=<sp/><ref refid="_reference_class_8cpp_1a1df4caf6a0641fd90e6044b6b29da131" kindref="member">stoS</ref>(trans_ref[(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)TARGETPART::MASTER]);</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.SlavePart<sp/>=<sp/>buffer-&gt;<ref refid="class_pre_stack_1a2dc1d77864de7e01e83891bd46777f7c" kindref="member">Getitem_from_index</ref>(2,<sp/>index[(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<ref refid="class_reference_class_1_1ref___pre_1aa03606a79215698128eb9e4c1c985c1ba79e19bc2ac33d6c81272024561992f37" kindref="member">TARGETPART::SLAVE</ref>]);</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.SlavePart_Ref<sp/>=<sp/><ref refid="_reference_class_8cpp_1a1df4caf6a0641fd90e6044b6b29da131" kindref="member">stoS</ref>(trans_ref[(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)TARGETPART::SLAVE]);</highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Contraint<sp/>Translate<sp/>Result&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>endl;</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cout<sp/>&lt;&lt;<sp/><ref refid="_reference_class_8cpp_1a27d7884109d4b05adb7fd28a8a98a7ce" kindref="member">Stos</ref>(result.MasterPart)<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/><ref refid="_reference_class_8cpp_1a27d7884109d4b05adb7fd28a8a98a7ce" kindref="member">Stos</ref>(result.MasterPart_Ref)<sp/>&lt;&lt;<sp/>endl;</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cout<sp/>&lt;&lt;<sp/><ref refid="_reference_class_8cpp_1a27d7884109d4b05adb7fd28a8a98a7ce" kindref="member">Stos</ref>(result.SlavePart)<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/><ref refid="_reference_class_8cpp_1a27d7884109d4b05adb7fd28a8a98a7ce" kindref="member">Stos</ref>(result.SlavePart_Ref)<sp/>&lt;&lt;<sp/>endl;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"></highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>endregion</highlight></codeline>
<codeline lineno="234"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="238" refid="class_reference_class_1_1ref___pre_1a68edab67fd4e452677bb5b2d783b5085" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_reference_class_1_1ref___pre_1a68edab67fd4e452677bb5b2d783b5085" kindref="member">ref_Pre::Parsing</ref>(String^<sp/>ref,<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal">*<sp/>product,<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal">*<sp/>part,<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal">*<sp/>geometry)<sp/>{</highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>temp<sp/>=<sp/><ref refid="_reference_class_8cpp_1a27d7884109d4b05adb7fd28a8a98a7ce" kindref="member">Stos</ref>(ref);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Product1/Part1.1/!Axis:(Selection_RSur:(Face:(Brp:(Pocket.1;0:(Brp:(Sketch.2;4)));None:();Cf11:());Pocket.1_ResultOUT;Z0;G3563))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>assem_product<sp/>=<sp/>temp.substr(0,<sp/>temp.find(</highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal">));<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Product1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>temp<sp/>=<sp/>temp.substr(temp.find(</highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal">)<sp/>+<sp/>1,<sp/>temp.size());<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Part1.1/!Axis:(Selection_RSur:(Face:(Brp:(Pocket.1;0:(Brp:(Sketch.2;4)));None:();Cf11:());Pocket.1_ResultOUT;Z0;G3563))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>assem_part<sp/>=<sp/>temp.substr(0,<sp/>temp.find(</highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal">));<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Part1.1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>temp<sp/>=<sp/>temp.substr(temp.find(</highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal">)<sp/>+<sp/>1,<sp/>temp.size());<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>assem_geometry<sp/>=<sp/>temp.substr(0,<sp/>temp.find(</highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal">));<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assem_geometry<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;\&quot;&quot;</highlight><highlight class="normal"><sp/>+<sp/>assem_geometry.substr(assem_geometry.find(</highlight><highlight class="charliteral">&apos;!&apos;</highlight><highlight class="normal">)<sp/>+<sp/>1,<sp/>assem_geometry.size())<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;\&quot;&quot;</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//&quot;Axis:(Selection_RSur:(Face:(Brp:(Pocket.1;0:(Brp:(Sketch.2;4)));None:();Cf11:());Pocket.1_ResultOUT;Z0;G3563))&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*product<sp/>=<sp/>assem_product;</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*part<sp/>=<sp/>assem_part;</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*geometry<sp/>=<sp/>assem_geometry;</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight></codeline>
<codeline lineno="258" refid="class_reference_class_1_1ref___pre_1a8d058d5b4069f52fe9673bc9202f3cd0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="class_reference_class_1_1ref___pre_1a8d058d5b4069f52fe9673bc9202f3cd0" kindref="member">ref_Pre::GetTransCADName_from_buffer</ref>(<ref refid="class_pre_stack" kindref="compound">PreStack</ref>^<sp/>buffer,<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal">*<sp/>Transcad_subAssemName,<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal">*<sp/>Transcad_partName,<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal">*<sp/>Transcad_geometry)<sp/>{</highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TransCAD::ICompPtr<sp/><ref refid="class_reference_class_1_1ref___pre_1a89793ff594f20a555df1142984c48da6" kindref="member">_spComp</ref>;</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>product<sp/>=<sp/><ref refid="class_reference_class_1_1ref___pre_1acad4634ae08a868ca337cf9020e21e18" kindref="member">pre_data</ref>-&gt;<ref refid="structparsing_1a602513d02949072c8892d5af6714c54c" kindref="member">assem_product</ref>;</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>part<sp/>=<sp/><ref refid="class_reference_class_1_1ref___pre_1acad4634ae08a868ca337cf9020e21e18" kindref="member">pre_data</ref>-&gt;<ref refid="structparsing_1adbcbf43366347f99b814fb375be7c162" kindref="member">assem_part</ref>;</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>geo<sp/>=<sp/><ref refid="class_reference_class_1_1ref___pre_1acad4634ae08a868ca337cf9020e21e18" kindref="member">pre_data</ref>-&gt;<ref refid="structparsing_1a5402c87864310e1985935b298bce61f9" kindref="member">assem_geometry</ref>;</highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Step1<sp/>:<sp/>Product1<sp/>를<sp/>통해서<sp/>TransCAD의<sp/>Component(SubAssembly)<sp/>Name과<sp/>Number를<sp/>가져옴</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>comp_num<sp/>=<sp/>stoi(product.substr(product.find(</highlight><highlight class="stringliteral">&quot;t&quot;</highlight><highlight class="normal">)<sp/>+<sp/>1,<sp/>product.size()));</highlight><highlight class="comment">//Product<sp/>숫자<sp/>Parsing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_spComp<sp/>=<sp/>(*_spAssem)-&gt;GetComponent(comp_num);</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*Transcad_subAssemName<sp/>=<sp/>(string)_spComp-&gt;get_Name();</highlight></codeline>
<codeline lineno="269"><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Step2-1<sp/>:<sp/>Part1.1<sp/>을<sp/>통해서<sp/>Part1<sp/>과<sp/>Part1의<sp/>Number를<sp/>가져옴</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>part_num<sp/>=<sp/>stoi(part.substr(part.find(</highlight><highlight class="stringliteral">&quot;.&quot;</highlight><highlight class="normal">)<sp/>+<sp/>1,<sp/>part.size()));</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>part<sp/>=<sp/>part.substr(0,<sp/>part.find(</highlight><highlight class="stringliteral">&quot;.&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Step2-2<sp/>:<sp/>buffer에서<sp/>Number<sp/>번째<sp/>Part1의<sp/>index를<sp/>가져옴</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>buffer_index<sp/>=<sp/>buffer-&gt;<ref refid="class_pre_stack_1ab97cfcc64415c2cb573333ea52d31ca8" kindref="member">Getindex_from_name</ref>(<ref refid="_reference_class_8cpp_1a1df4caf6a0641fd90e6044b6b29da131" kindref="member">stoS</ref>(part),<sp/>part_num);</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Step2-3<sp/>:<sp/>buffer에서<sp/>index에<sp/>해당하는<sp/>transcad<sp/>name을<sp/>가져옴</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*Transcad_partName<sp/>=<sp/><ref refid="_reference_class_8cpp_1a27d7884109d4b05adb7fd28a8a98a7ce" kindref="member">Stos</ref>(buffer-&gt;<ref refid="class_pre_stack_1a2dc1d77864de7e01e83891bd46777f7c" kindref="member">Getitem_from_index</ref>(2,<sp/>buffer_index));</highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"></highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Step3<sp/>:<sp/>CATScript로부터<sp/>Geometry를<sp/>변환</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>_path<sp/>=<sp/><ref refid="_reference_class_8cpp_1a27d7884109d4b05adb7fd28a8a98a7ce" kindref="member">Stos</ref>(buffer-&gt;<ref refid="class_pre_stack_1a2dc1d77864de7e01e83891bd46777f7c" kindref="member">Getitem_from_index</ref>(0,<sp/>buffer_index));</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_path<sp/>=<sp/>_path.substr(0,<sp/>_path.find_last_of(</highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal">))<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;.CATScript&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="283"><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_pre_1_1_part" kindref="compound">Pre::Part</ref>*<sp/>pPart<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_pre_1_1_part" kindref="compound">Pre::Part</ref>(_path,<sp/>1);</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pPart-&gt;<ref refid="class_pre_1_1_part_1a8b5e2a2bbf385223d67ce40232b23e45" kindref="member">GetInfo</ref>();<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Part<sp/>정보<sp/>읽기</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_pre_1_1_reference_entity" kindref="compound">Pre::ReferenceEntity</ref>*<sp/>_refer<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_pre_1_1_reference_entity" kindref="compound">Pre::ReferenceEntity</ref>(pPart,<sp/>0,<sp/></highlight><highlight class="stringliteral">&quot;a&quot;</highlight><highlight class="normal">);<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Part에서<sp/>Feature정보<sp/>추출</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(geo.substr(1,<sp/>6)<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;Axis:(&quot;</highlight><highlight class="normal">)<sp/>{<sp/>geo<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;\&quot;&quot;</highlight><highlight class="normal"><sp/>+<sp/>geo.substr(7,<sp/>geo.size());<sp/>}</highlight><highlight class="comment">//축을<sp/>선택한<sp/>것이라면<sp/>맨<sp/>앞부분<sp/>Axis<sp/>제거</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>ptr<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)geo.c_str();</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*Transcad_geometry<sp/>=<sp/>*Transcad_subAssemName<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;,&quot;</highlight><highlight class="normal"><sp/>+<sp/>*Transcad_partName<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;,&quot;</highlight><highlight class="normal"><sp/>+<sp/>_refer-&gt;<ref refid="class_pre_1_1_reference_entity_1ab193a350f007a3546577bf6171a50889" kindref="member">GetReferName</ref>(ptr);</highlight></codeline>
<codeline lineno="291"><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>_refer;</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//delete<sp/>pPart;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_reference_class_1_1ref___pre_1acad4634ae08a868ca337cf9020e21e18" kindref="member">pre_data</ref>-&gt;<ref refid="structparsing_1a291835b970e948e4aefe92403bcd5589" kindref="member">product_num</ref><sp/>=<sp/>comp_num;</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_reference_class_1_1ref___pre_1acad4634ae08a868ca337cf9020e21e18" kindref="member">pre_data</ref>-&gt;<ref refid="structparsing_1a280067936b80cf528e48af66c750c81c" kindref="member">part_num</ref><sp/>=<sp/>part_num;</highlight></codeline>
<codeline lineno="297"><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>buffer_index;</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="302"><highlight class="normal"></highlight></codeline>
<codeline lineno="303" refid="class_reference_class_1_1ref___pre_1ac8cd404fe503874a3b72314edf6c07ae" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/><ref refid="class_reference_class_1_1ref___pre_1ac8cd404fe503874a3b72314edf6c07ae" kindref="member">ref_Pre::Constraint_to_TransCAD</ref>(TransCAD::IStdAssemConstraintsPtr<sp/>f,<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>type,<sp/>TransCAD::IPartPtr<sp/>master,<sp/>TransCAD::IReferencePtr<sp/>master_ref,<sp/>TransCAD::IPartPtr<sp/>slave,<sp/>TransCAD::IReferencePtr<sp/>slave_ref,<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>option,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">^<sp/>option_int)<sp/>{</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>re;</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(option<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;move&quot;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TransCAD::ICompPtr<sp/>_lomp<sp/>=<sp/>(*_spAssem)-&gt;GetComponent(<ref refid="class_reference_class_1_1ref___pre_1acad4634ae08a868ca337cf9020e21e18" kindref="member">pre_data</ref>-&gt;<ref refid="structparsing_1a291835b970e948e4aefe92403bcd5589" kindref="member">product_num</ref>);</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_lomp-&gt;SetPartPlacement(master,<sp/>10,<sp/>100,<sp/>100,<sp/>0,<sp/>0,<sp/>1,<sp/>1,<sp/>0,<sp/>0);</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(*_spAssemDocument)-&gt;Update();</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="310"><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(type<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;catCstTypeOn&quot;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="313"><highlight class="normal"></highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f-&gt;AddNewAssemblyCoaxialConstraint(</highlight><highlight class="stringliteral">&quot;Coaxial&quot;</highlight><highlight class="normal">,<sp/>master,<sp/>master_ref,<sp/>slave,<sp/>slave_ref);</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>re<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Coaxial&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="316"><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(type<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;catCstTypeSurfContact&quot;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(option<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;same&quot;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f-&gt;AddNewAssemblyIncidenceConstraint(</highlight><highlight class="stringliteral">&quot;Incidence&quot;</highlight><highlight class="normal">,<sp/>master,<sp/>master_ref,<sp/>slave,<sp/>slave_ref,<sp/>TransCAD::StdAssemblyIncidenceType::Same);</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f-&gt;AddNewAssemblyIncidenceConstraint(</highlight><highlight class="stringliteral">&quot;Incidence&quot;</highlight><highlight class="normal">,<sp/>master,<sp/>master_ref,<sp/>slave,<sp/>slave_ref,<sp/>TransCAD::StdAssemblyIncidenceType::Opposite);</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="326"><highlight class="normal"></highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>re<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Incidence&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>re<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;None&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="332"><highlight class="normal"></highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="334"><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>re;</highlight></codeline>
<codeline lineno="336"><highlight class="normal"></highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="338"><highlight class="normal"></highlight></codeline>
<codeline lineno="339"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="C:/Users/helen/Desktop/CATIATranslator/Translator_CATIA/CPPWITHCSHARP/ReferenceClass_Pre.cpp"/>
  </compounddef>
</doxygen>
